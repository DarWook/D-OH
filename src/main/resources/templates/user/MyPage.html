<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/fragments/layout}" lang="kr">

<head>
    <link rel="stylesheet" th:href="@{/css/user/MyPage.css}">
    <script src="/js/user/MyPageUpload.js" defer></script>
    <script>
        function viewAwardResult(conNum) {
    $.ajax({
        url: '/users/contest/award/result', // 요청할 서버의 URL
        type: 'GET', // GET 요청 방식
        data: { conNum: conNum }, // 쿼리스트링으로 conNum 전송
        success: function(response) {
            // 요청이 성공했을 때 처리할 로직
            console.log("서버 응답: ", response);
            alert("결과를 성공적으로 가져왔습니다.");

            // 응답 결과를 HTML에 표시 (예: 특정 섹션에 결과 표시)
            $("#resultSection").html(response);
        },
        error: function(xhr, status, error) {
            console.error('결과를 가져오는 중 오류 발생: ', error);
            alert("결과를 가져오는 중 오류가 발생했습니다.");
        }
    });
}

    </script>
</head>
<th:block layout:fragment="content">
    <body>
    <!-- <banner>
        <img th:src="@{/img/banner.png}" alt="banner"  height="240px">
    </banner> -->
    <form method="get" action="/users/mypage">
    <main>
        <div class="container">
            <div class="sidebar">
                <img th:src="@{/img/quokka.jpg}" alt="quokka"><br>
                <div class="username">
                    <p th:if="${profile != null and profile?.userNickName != null}" th:text="${profile?.userNickName}" style="font-size: 15px"></p>
                    <p th:if="${profile == null or profile?.userNickName == null}" th:text="${myPageDTO?.userEmail}"></p>
                </div>
                <div>
                    <p th:if="${profile != null and profile?.myPageUrl != null}" th:text="${profile?.myPageUrl}"></p>
                    <p th:if="${profile == null or profile?.myPageUrl == null}">정보 없음</p>
                </div>
                <a href="/users/mypage/profile/write" class="edit-profile">프로필 수정하기</a>
                <div class="activity">
                    <div class="section-title">
                        <h6>라우드 활동</h6>
                    </div>
                    <div>
                        연락 가능 시간: <p th:if="${profile != null and profile?.messageStart != null}" th:text="${profile.messageStart}"></p>~
                        <p th:if="${profile == null or profile?.messageStart == null}">정보 없음</p>
                        <p th:if="${profile != null and profile?.messageEnd != null}" th:text="${profile.messageEnd}"></p>
                        <p th:if="${profile == null or profile?.messageEnd == null}">정보 없음</p>
                    </div>
                </div>
            </div> <!-- sidebar end -->
            <div class="main-class">

                <h3>내가 개최한 컨테스트 목록보기</h3>
                <table>
                    <thead>
                    <tr>
                        <th>No.</th>
                        <th>제목</th>
                        <th>모집 기간</th>
                        <th>조회수</th>
                        <th>바로 가기</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="contest : ${contestList}">
                        <td th:text="${contest.id}">1</td>
                        <td th:text="${contest.conTitle}">Contest Title</td>
                        <td th:text="${#dates.format(contest.conStartDate, 'yyyy-MM-dd')} + ' - ' + ${#dates.format(contest.conEndDate, 'yyyy-MM-dd')}">2024-09-25 ~ 2024-10-01</td>
                        <td th:text="${contest.conHit}">Hit</td>
                        <td>
                            <a th:href="@{/contest/view?contestNum={id}(id=${contest.id})}" class="action-btn">바로가기</a>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <h3>내가 지원한 컨테스트 목록보기</h3>
                <table>
                    <thead>
                    <tr>
                        <th>Contest No.</th>
                        <th>제목</th>
                        <th>지원 날짜</th>
                        <th>결과 보기</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="applylist : ${applicationList}">
                        <td th:text="${applylist.conNum}">1</td>
                        <td th:text="${applylist.applyTitle}">Contest Title</td>
                        <td th:text="${#dates.format(applylist.applyDate, 'yyyy-MM-dd')}">2024-09-25 </td>
                        <<td>
                        <!-- 버튼 클릭 시 자바스크립트 함수 호출 -->
                        <button type="button" th:onclick="'viewAwardResult(' + ${applylist.conNum} + ')' " class="action-btn">결과 보기</button>
                    </td>


                    </tr>
                    </tbody>
                </table>


                <a href="/users/mypage/profile/write" class="profilewrite" th:if="${profile == null or profile?.profileOneLiner == null}">프로필 작성하러가기</a>
                <div class="profileOneLiner">
                    <p th:if="${profile != null and profile?.profileOneLiner != null}" th:text="${profile?.profileOneLiner}"></p>
                </div>
                <div class="profileIntroduce">
                    <p th:if="${profile !=null and profile?.profileIntroduce != null}" th:text="${profile?.profileIntroduce}"></p>
                </div>
            </div>
            <div class="button-class">
                <div class="profilesetting">
                    <a href="/users/mypage" class="underline">프로필 설정</a>
                </div>
                <div class="portfolio">
                     <a href="/users/mypage/portfolio" class="underline">포트폴리오</a>
                </div>
                <div class="upload">
                    <a href="/users/mypage/upload" class="underline">작품 업로드하기</a>
                </div>
            </div> <!-- button-class end -->
<!--            <div class="management">-->
<!--                <div><h6>참여한 공모전</h6><hr></div>-->
<!--                <div class="imagecard"></div>-->
<!--                <div class="imagecard"></div>-->
<!--                <div class="imagecard"></div>-->
<!--                <div class="imagecard"></div>-->
<!--                <div class="imagecard"></div>-->

<!--            </div>-->
<!--            <div class="commition">-->
<!--                <div><h6>공모전 의뢰 목록</h6><hr></div>-->
<!--                <div class="commition1">-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                    <div>회사를 차리는데 회사 이름 추천 해주세요~</div>-->
<!--                </div>-->
<!--            </div>-->


            </div> <!-- container end -->
        </main>
    </form>
    </body>
</th:block>

</html>
